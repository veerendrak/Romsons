

<section class="card" id="mainContent">

	<div class="card-header card-header-adjustments">
		<span class="cat__core__title"> <strong class="page-title">User
				Management</strong>
		</span>
		<span class="pull-right" style="max-width:90px;">	
			
				<button class="btn login-button" id="add_user" style="width: 100% !important;" 
					data-toggle="modal"  (click)="openModal()">
					<i class="fa fa-plus" style="margin-right:4px;"></i> Add User
				</button>
			
		</span>
	</div>

	<div class="card-block">
	
		<table class="table table-hover nowrap" id="userListTable"
			width="100%" style="position: none !important;" >
			<thead class="thead-default">
				<tr>
					<!-- <th><div class="checkbox align-center"
							style="text-align: center;">
							<input id="checkbox_bulk" class="styled" type="checkbox">
							<label for="checkbox_bulk"> </label>
						</div></th> -->
					<th>E-mail</th>
					<th>Username</th>
					<th>Mobile</th>
					<th>Role</th>
					<th>Organization/Bussiness</th>
					<th class="centerAlign">Actions</th>
					<!-- <th class="centerAlign">Reset Password</th>
					<th class="centerAlign">Edit</th>
					<th class="centerAlign">Remove</th> -->
				</tr>
			</thead>
			<tbody>

				<tr *ngFor="let items of orgUsers, let i=index">
					
					<td data-toggle="tooltip" title={{items.email}}>{{items.email}}</td>
					<td data-toggle="tooltip" title={{items.firstName}} >{{items.firstName}} {{items.lastName}}</td>
					<td data-toggle="tooltip" title={{items.mobile}}>{{items.mobile}}</td>
					<td  data-toggle="tooltip" title={{items.role}}>{{items.role}}</td>
					<td  data-toggle="tooltip" title={{items.bpLegalName}}>{{items.bpLegalName}}</td>
					<td class="centerAlign">
					<span *ngIf="userRole!='Business Place Admin'">
					<span data-toggle="tooltip"
						title="Reset Password" (click)="resetPassword(items.userId)">
						<i
							class="icmn-history cursor-hand-custom custom-hover"
							aria-hidden="true"></i> </span>
					 <span data-toggle="tooltip"
						title="Edit User" (click)="edituserDetails(items,'editUser')"> <a
							href="javascript: void(0);" class="mr-2" data-toggle="modal"
							data-target="#addUser"><i
								class="icmn-pencil cursor-hand-custom"> </i></a>
					</span> <span data-toggle="tooltip" title="Remove User"
						(click)="deleteUser(items)"> <a
							class="swal-btn-cancel deleteUser"> <i
								class="icmn-bin cursor-hand-custom" style="color: red"></i>
						</a></span>
						</span>
					<span *ngIf="userRole=='Business Place Admin'">
					<span *ngIf="items.role!='Organization Admin'">
					<span data-toggle="tooltip"
						title="Reset Password" (click)="resetPassword(items.userId)">
						<i
							class="icmn-history cursor-hand-custom custom-hover"
							aria-hidden="true"></i> </span> <span data-toggle="tooltip"
						title="Edit User" (click)="edituserDetails(items,'editUser')"> <a
							href="javascript: void(0);" class="mr-2" data-toggle="modal"
							data-target="#addUser"><i
								class="icmn-pencil cursor-hand-custom"> </i></a>
					</span> <span data-toggle="tooltip" title="Remove User"
						(click)="deleteUser(items)"> <a
							class="swal-btn-cancel deleteUser"> <i
								class="icmn-bin cursor-hand-custom" style="color: red"></i>
						</a></span>
						</span>
						</span>
				
						</td>
				</tr>
			</tbody>
		</table>


	</div>
</section>

<div class="modal fade modal-size-medium" id="addUser" tabindex="-1"
	role="dialog" aria-labelledby="" aria-hidden="true" data-backdrop="static" data-keyboard="false" >
	<div class="modal-dialog" role="document">
		<div class="modal-content">
		<form [formGroup]="addUserForm" (ngSubmit)="submituserDetails()">
												<div class="modal-header">
				<div class="row new_row">
					<div class="pull-left new_left">
						<h4 id="myModalLabel" *ngIf="isAddUser">Add User</h4>
						<h4 id="myModalLabel" *ngIf="!isAddUser">Edit User</h4>
					</div>
					<div class="pull-right new_right">
						<button type="button" class="close" id="close"  data-dismiss="modal"
					aria-label="Close">
							<i class="fa fa-times fa" aria-hidden="true"></i>
						</button>
					</div>
				</div>


			</div>
					
			<div class="modal-body addrole-body" style="padding: 0 6px !important;">



				<div class="card-block addrole-block">
						
								<!-- Popup Form Validation -->
								
									<div class="row">
										<div class="col-md-12 padd-align">
											<label>Role<sup class="asterick">*</sup>
											</label> <select class="form-control create-edit-pop-txt-box"
												 formControlName="roleId"
												validateOnBlur
												[validateFormControl]="addUserForm.controls['roleId']"
												>
												<option value="">Select Role</option>
												<ng-container *ngFor="let roles of orgRoles">
												<option													
													value={{roles.id}}>{{roles.value}}</option>
												
												</ng-container>
											</select> <span
												*ngIf="addUserForm.controls['roleId'].touched && !addUserForm.controls['roleId'].valid && addUserForm.controls['roleId'].dirty"
												class="error"> <small
												*ngIf="addUserForm.controls['roleId'].errors.required">
													Please select Role </small>

											</span>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12 padd-align">
											<label>E-mail<sup class="asterick">*</sup></label> <input
												type="text" class="form-control create-edit-pop-txt-box"
												formControlName="email" validateOnBlur #email
												[validateFormControl]="addUserForm.controls['email']"
												placeholder="email" >
											<div id="popover-next"
												class="popover fade bs-tether-element bs-tether-enabled bs-tether-element-attached-middle bs-tether-element-attached-left bs-tether-target-attached-middle bs-tether-target-attached-right show"
												role="tooltip"
												style="top: -38px; display: none; margin-left: 99px; max-width: 365px; position: absolute;">
												<h3 class="popover-title"></h3>
												 <div class="popover-content">
													<div *ngIf="!isBranchUser">
																<p>{{assignBpartner}}</p>
													</div>
													<div *ngIf="isBranchUser">
														<p>  {{alreadyExisted}}</p>
													</div>
													<div class="form-actions role-buttons">
														<button class="btn btn-primary role-button" type="button"
															*ngIf="!isBranchUser" (click)="existedUserToOtherBpartner(addUserToBpartner)">Add</button>
														<button
															class="btn btn-default remove-error role-cancel click_me"
															type="button" (click)="cancelPopup('popover-next')">Cancel</button>
													</div>
												</div>
											</div>
			
			
											<span
												*ngIf="addUserForm.controls['email'].touched && !addUserForm.controls['email'].valid"
												class="error"> <small
												*ngIf="addUserForm.controls['email'].errors.required">
													Please enter email id</small> <small
												*ngIf="addUserForm.controls['email'].errors.pattern">
													Invalid email id </small>
											</span>
										</div>
			
									</div>
									<div class="user-next-block" *ngIf="opendiv">
									
									<div class="row">
										<div class="col-md-12 padd-align">
											<label>First name<sup class="asterick">*</sup></label> <input
												type="text" class="form-control create-edit-pop-txt-box"
												formControlName="firstName" validateOnBlur 
												[validateFormControl]="addUserForm.controls['firstName']"
												placeholder="First name" >
			
											<span
												*ngIf="addUserForm.controls['firstName'].touched && !addUserForm.controls['firstName'].valid"
												class="error"> <small
												*ngIf="addUserForm.controls['firstName'].errors.required">
													Please enter firstName </small> 
											</span>
										</div>
			
									</div>
									
									<div class="row">
										<div class="col-md-12 padd-align">
											<label>Last name<sup class="asterick">*</sup></label> <input
												type="text" class="form-control create-edit-pop-txt-box"
												formControlName="lastName" validateOnBlur
												[validateFormControl]="addUserForm.controls['lastName']"
												placeholder="Last name" >
			
											<span
													*ngIf="addUserForm.controls['lastName'].touched && !addUserForm.controls['lastName'].valid && addUserForm.controls['lastName'].dirty"
													class="error"> <small
													*ngIf="addUserForm.controls['lastName'].errors.required">
														Please enter last name </small>
												</span>
										</div>
			
									</div>
									
											
											<input type="hidden" value="REG_USERS" formControlName="userType">


										<div class="row">
											<div class="col-md-12 padd-align">
												<label>Mobile<sup class="asterick">*</sup></label> <input
													type="text" class="form-control create-edit-pop-txt-box"
													formControlName="mobile" validateOnBlur
													[validateFormControl]="addUserForm.controls['mobile']"
													placeholder="Mobile" >
			
												<span
													*ngIf="addUserForm.controls['mobile'].touched && !addUserForm.controls['mobile'].valid && addUserForm.controls['mobile'].dirty"
													class="error"> <small
													*ngIf="addUserForm.controls['mobile'].errors.required">
														Plese enter mobile number </small> <small
													*ngIf="addUserForm.controls['mobile'].errors.pattern">
														Please enter a valid mobile number </small>
												</span>
											</div>
			
										</div>
			
									</div>
									
									
									<div style="display: none;">
										<input class="form-control" formControlName="logonId"
											type="text"> <input class="form-control"
											formControlName="role" type="text"> <input
											class="form-control" formControlName="userId" type="text">
										<input class="form-control" formControlName="bpLegalName"
											type="text">
									</div>

									
								
								<!-- End Popup Form Validation -->
				</div>
			</div>
			
			<div class="modal-footer">
			<div class="row new_row">
			<div *ngIf="!opendiv" class="pull-right mr18 act_foot"  style="max-width:47%">
										<button type="button" style="padding: 5px 5px 5px 5px; margin-top: 2px;"
											(click)="finduserStatus(email.value)"
											[disabled]="(!addUserForm.controls['email'].valid || !addUserForm.controls['roleId'].valid)"
											class="btn login-button "
											>Next</button>
										<button class="btn login-button"
											style="display: none;">Click here</button>
									</div>
			<div class="pull-right mr18  act_foot" *ngIf="opendiv"  style="max-width:47%;"
										>
										<button type="submit" style="padding: 5px 5px 5px 5px; margin-top: 2px;"
											class="btn login-button" id="user_mgmt" [disabled]="!addUserForm.valid">
											<i class="fa fa-hand-pointer-o" style="margin-right: 8px;font-size:16px;"></i>
											Submit</button>
										<button type="button"
											class="cancel-button-export" style="padding-left:0px;"
											id="adduserDetails" (click)="reset()">
											<i class="fa cancel-icon" style="margin-right:4px;padding-right:4px;">
										<span class="icon-text" style="right:-4px;">Cancel</span>
										</i>
										</button>
											
											
									</div>
			</div>
			
			
			
			
			
			
			
			</div>
			
			</form>
		</div>
	</div>
</div>